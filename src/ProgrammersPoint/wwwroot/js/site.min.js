function CheckNieuwePosts(){if(typeof Storage!="undefined"){var n=CheckNotificatieMogelijkheid();n&&$.ajax({url:"/Home/HaalOngelezenPostsOp",success:function(n){var t=JSON.parse(n);nieuwePosts=[];t!=null&&(FilterNieuwePosts(t),MaakEnStuurNotificatie())},error:function(){}})}}function FilterNieuwePosts(n){var i=JSON.parse(localStorage.getItem("gelezenPosts")),t;for(Array.isArray(i)||(i=[]),t=0;t<n.length;t++)i.indexOf(n[t].PostId)<0&&nieuwePosts.push(n[t])}function CheckNotificatieMogelijkheid(){if("Notification"in window){if(Notification.permission==="granted")return!0;Notification.permission!=="denied"&&Notification.requestPermission(function(n){return n==="granted"?!0:!1})}else return!1;return!1}function MaakEnStuurNotificatie(){var t,n,i;if(nieuwePosts.length!==0){for(t=nieuwePosts.length===1?"Er is 1 nieuwe post beschikbaar: ":"Er zijn "+nieuwePosts.length+" nieuwe posts beschikbaar: ",n=0;n<nieuwePosts.length;n++)t+=n===nieuwePosts.length-1?nieuwePosts[n].Naam+".":nieuwePosts[n].Naam+", ";i=new Notification("Nieuwe post",{body:t,icon:"/images/Logo.png"});i.onclick=function(n){n.preventDefault();nieuwePosts.length===1?window.open("/Posts/Post/"+nieuwePosts[0].PostId,"_self"):window.open("/Posts/","_self");i.close()};VoegGelezenPostsAanLocalStorageToe()}}function VoegGelezenPostsAanLocalStorageToe(){var n=JSON.parse(localStorage.getItem("gelezenPosts")),t;for(Array.isArray(n)||(n=[]),t=0;t<nieuwePosts.length;t++)n.indexOf(nieuwePosts[t].PostId)<0&&(n.push(nieuwePosts[t].PostId),localStorage.setItem("gelezenPosts",JSON.stringify(n)))}var nieuwePosts=[];$(window).load(function(){setInterval(CheckNieuwePosts,1e4)});